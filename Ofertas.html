<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ofertas Relâmpago</title>
    <style>
        /* ESTILOS GERAIS */
        body { font-family: 'Segoe UI', sans-serif; background: #f4f7f6; margin: 0; padding: 15px; color: #333; }
        .container { max-width: 1100px; margin: 0 auto; }
        
        /* CABEÇALHO */
        header { text-align: center; margin-bottom: 30px; }
        header h1 { color: #d32f2f; margin: 0; font-size: 2rem; }
        .nav-bar { margin-top: 15px; display: flex; justify-content: center; gap: 10px; }
        .nav-btn { text-decoration: none; padding: 8px 16px; border-radius: 20px; font-weight: bold; font-size: 0.9rem; transition: 0.2s; }
        .nav-btn.active { background: #d32f2f; color: white; }
        .nav-btn.inactive { background: white; color: #555; border: 1px solid #ddd; }

        /* GRID (2 COLUNAS NO MOBILE) */
        .grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); 
            gap: 20px; 
        }
        @media (max-width: 600px) {
            .grid { 
                grid-template-columns: repeat(2, 1fr); 
                gap: 10px; 
            }
            body { padding: 10px; }
        }

        /* CARD PRODUTO */
        .card { 
            background: white; border-radius: 12px; overflow: hidden;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05); display: flex; flex-direction: column;
            transition: transform 0.2s; position: relative;
        }
        .card:hover { transform: translateY(-3px); }
        .card.expired { opacity: 0.6; filter: grayscale(1); pointer-events: none; }

        /* IMAGEM */
        .card-img-box { 
            width: 100%; padding-top: 100%; /* Quadrado */ position: relative; background: #fff; 
        }
        .card-img { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
            object-fit: contain; padding: 15px; 
        }

        /* CONTEÚDO */
        .card-body { padding: 15px; display: flex; flex-direction: column; flex-grow: 1; }
        
        .store-tag { 
            font-size: 0.7rem; text-transform: uppercase; font-weight: 800; color: #777; margin-bottom: 5px; 
        }
        
        h2 { 
            font-size: 1rem; margin: 0 0 10px; line-height: 1.3; color: #222;
            display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden;
            height: 3.9em; /* Altura fixa para alinhar */
        }
        @media (max-width: 600px) { h2 { font-size: 0.9rem; height: 3.6em; } }

        .prices { margin-top: auto; }
        .price-from { font-size: 0.8rem; color: #999; text-decoration: line-through; }
        .price-to { font-size: 1.4rem; color: #2e7d32; font-weight: 800; display: block; }
        
        .btn-buy { 
            background: #28a745; color: white; text-align: center; padding: 10px; 
            border-radius: 6px; text-decoration: none; font-weight: bold; 
            margin-top: 15px; display: block; font-size: 0.9rem;
        }
        
        .loader { text-align: center; padding: 50px; font-size: 1.2rem; color: #666; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>⚡ Ofertas Relâmpago</h1>
        <div class="nav-bar">
            <a href="/" class="nav-btn inactive">Loja</a>
            <a href="#" class="nav-btn active">Ofertas</a>
            <a href="/Cupons" class="nav-btn inactive">Cupons</a>
        </div>
    </header>

    <div id="loader" class="loader">Procurando as melhores ofertas...</div>
    <div id="grid" class="grid"></div>
</div>

<script>
    // --- ATENÇÃO: MANTENHA A URL DO SEU SCRIPT AQUI ---
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxfjjVm4HkUnQfUXv8U6iZx1lcJbkxwyVkLyYRjhHpap8_MunaY7goBE_Fwc-_UeNTi8w/exec";

    async function load() {
        const grid = document.getElementById('grid');
        try {
            // Pede apenas ofertas (produtos com preço/foto)
            const req = await fetch(`${SCRIPT_URL}?type=ofertas`);
            const data = await req.json();
            
            document.getElementById('loader').style.display = 'none';
            if(!data.length) { grid.innerHTML = '<p style="text-align:center;width:100%">Sem ofertas.</p>'; return; }

            data.sort((a,b) => a.expirado - b.expirado);

            data.forEach(item => {
                // Se não tiver imagem, usa placeholder
                const imgUrl = item.imagem || "https://via.placeholder.com/300?text=Oferta";
                
                const card = document.createElement('div');
                card.className = `card ${item.expirado ? 'expired' : ''}`;
                
                let htmlPreco = '';
                if(item.por) {
                   htmlPreco = `<div class="prices">${item.de ? `<span class="price-from">De ${item.de}</span>` : ''}<span class="price-to">Por ${item.por}</span></div>`;
                }

                card.innerHTML = `
                    <div class="card-img-box"><img src="${imgUrl}" class="card-img" loading="lazy"></div>
                    <div class="card-body">
                        <div class="store-tag">${item.loja}</div>
                        <h2>${item.titulo}</h2>
                        ${htmlPreco}
                        <a href="${item.link}" target="_blank" class="btn-buy">${item.expirado ? 'ENCERRADO' : 'VER OFERTA'}</a>
                    </div>
                `;
                grid.appendChild(card);
            });
        } catch(e) { console.log(e); }
    }
    load();
</script>

</body>
</html>
